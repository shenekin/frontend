<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Chinese Learning Platform Admin & Learner</title>
<style>
  body { font-family: Arial; background:#f4f7f9; margin:0; padding:0; }
  header { background:#c71585; color:white; padding:1rem; text-align:center;}
  main { display:flex; gap:2rem; padding:2rem; flex-wrap:wrap;}
  .panel { background:white; padding:1rem; border-radius:8px; flex:1 1 400px; box-shadow:0 2px 6px rgba(0,0,0,0.1);}
  h2 { color:#c71585; }
  ul { list-style:none; padding-left:0;}
  li { margin-bottom:0.5rem;}
  button { padding:0.3rem 0.6rem; margin-left:0.3rem; border:none; border-radius:4px; background:#c71585; color:white; cursor:pointer;}
  button:hover { background:#a10d70; }
  input { margin:0.3rem 0; padding:0.4rem; width:90%;}
</style>
</head>
<body>
<header>
  <h1>Chinese Learning Platform</h1>
</header>
<main>
  <!-- Admin Panel -->
  <div class="panel">
    <h2>Admin: Manage Courses</h2>
    <input type="text" id="course-name" placeholder="New course name">
    <button onclick="addCourse()">Add Course</button>
    <ul id="admin-course-list"></ul>
  </div>

  <!-- Learner Panel -->
  <div class="panel">
    <h2>Learner: Courses</h2>
    <ul id="learner-course-list"></ul>
    <h2>Learning Records</h2>
    <ul id="learning-records"></ul>
  </div>
</main>

<script>
  // Load from localStorage or initialize
  let courses = JSON.parse(localStorage.getItem('courses')) || [];
  let learnerProgress = JSON.parse(localStorage.getItem('learnerProgress')) || {};

  function saveData() {
    localStorage.setItem('courses', JSON.stringify(courses));
    localStorage.setItem('learnerProgress', JSON.stringify(learnerProgress));
  }

  // Admin functions
  function renderAdminCourses() {
    const list = document.getElementById('admin-course-list');
    list.innerHTML = '';
    courses.forEach((course, index) => {
      const li = document.createElement('li');
      li.textContent = course.name;
      const editBtn = document.createElement('button');
      editBtn.textContent = 'Edit';
      editBtn.onclick = () => editCourse(index);
      const deleteBtn = document.createElement('button');
      deleteBtn.textContent = 'Delete';
      deleteBtn.onclick = () => deleteCourse(index);
      const addLessonBtn = document.createElement('button');
      addLessonBtn.textContent = 'Add Lesson';
      addLessonBtn.onclick = () => addLesson(index);
      li.appendChild(editBtn); li.appendChild(deleteBtn); li.appendChild(addLessonBtn);
      list.appendChild(li);
    });
  }

  function addCourse() {
    const name = document.getElementById('course-name').value.trim();
    if(name) {
      courses.push({name, lessons: []});
      document.getElementById('course-name').value = '';
      renderAdminCourses();
      renderLearnerCourses();
      saveData();
    }
  }

  function editCourse(index) {
    const newName = prompt('Edit course name:', courses[index].name);
    if(newName) {
      courses[index].name = newName.trim();
      renderAdminCourses();
      renderLearnerCourses();
      saveData();
    }
  }

  function deleteCourse(index) {
    if(confirm(`Delete "${courses[index].name}"?`)) {
      courses.splice(index,1);
      renderAdminCourses();
      renderLearnerCourses();
      saveData();
    }
  }

  function addLesson(courseIndex) {
    const lessonName = prompt('Lesson name:');
    if(lessonName) {
      courses[courseIndex].lessons.push(lessonName.trim());
      renderLearnerCourses();
      saveData();
    }
  }

  // Learner functions
  function renderLearnerCourses() {
    const list = document.getElementById('learner-course-list');
    list.innerHTML = '';
    courses.forEach((course,index)=>{
      const li = document.createElement('li');
      li.textContent = course.name;
      const progress = learnerProgress[course.name] || {lastPosition:0, completed:false};
      if(course.lessons.length > 0) {
        if(!progress.completed){
          const lessonName = course.lessons[progress.lastPosition];
          const btn = document.createElement('button');
          btn.textContent = 'Study Next Lesson';
          btn.onclick = ()=>studyLesson(course.name);
          li.textContent += ` (Next: ${lessonName})`;
          li.appendChild(btn);
        } else {
          li.textContent += ' âœ… Completed';
        }
      } else {
        li.textContent += ' (No lessons)';
      }
      list.appendChild(li);
    });
    renderLearningRecords();
  }

  function studyLesson(courseName) {
    const course = courses.find(c=>c.name===courseName);
    if(!course) return;
    const progress = learnerProgress[courseName] || {lastPosition:0, completed:false};
    if(progress.lastPosition < course.lessons.length){
      alert(`Studied: ${course.lessons[progress.lastPosition]}`);
      progress.lastPosition++;
      if(progress.lastPosition === course.lessons.length) progress.completed=true;
      learnerProgress[courseName] = progress;
      saveData();
      renderLearnerCourses();
    }
  }

  function renderLearningRecords(){
    const list = document.getElementById('learning-records');
    list.innerHTML = '';
    Object.entries(learnerProgress).forEach(([course, prog])=>{
      if(prog.completed){
        const li = document.createElement('li');
        li.textContent = `${course} - Completed`;
        list.appendChild(li);
      }
    });
  }

  // Initial render
  renderAdminCourses();
  renderLearnerCourses();
</script>
</body>
</html>
